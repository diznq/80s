#! GET /time
<?hpp 
#include <ctime> 
#include "main.hpp"
?><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <?cpp
        auto ctx = env.local_context<default_context>();
        auto name = env.query("name");
        if(name) {
            | <h1>Hi, #[[name.value()]]</h1>
        } else {
            | <h1>Hello!</h1>
        }
        std::time_t t = std::time(NULL);
        std::tm *tm = std::localtime(&t);
        const char *days[] = {"Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"};

        | <h2>Today is: #[[ days[tm->tm_wday] ]]</h2>
    ?>
    <br>
    <hr>
    <?cpp
        | <p>This is coming from global context: #[[ ctx->get_message() ]]</p>
        auto posts = co_await ctx->get_posts();
        if(posts.size() == 0) {
            | <h3>No posts found</h3>
        } else {
            for(auto& p : posts) {
                | <div class="post">
                |  <p>Author: #[[ p.author ]]</p>
                |  <p>#[[p.text]]</p>
                | </div>
                | <hr>
            }
        }
    ?>
</body>
</html>